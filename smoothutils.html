
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>smoothutils &#8212; HydPy 2.0.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="annutils" href="annutils.html" />
    <link rel="prev" title="pointerutils" href="pointerutils.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="annutils.html" title="annutils"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pointerutils.html" title="pointerutils"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="cythons.html" accesskey="U">Cythons Modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="smoothutils">
<span id="id1"></span><h1>smoothutils<a class="headerlink" href="#smoothutils" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-hydpy.cythons.autogen.smoothutils"></span><p>This Cython module implements the performance-critical functions of the
Python module <a class="reference internal" href="smoothtools.html#module-hydpy.auxs.smoothtools" title="hydpy.auxs.smoothtools"><code class="xref py py-mod docutils literal"><span class="pre">smoothtools</span></code></a>.</p>
<dl class="function">
<dt id="hydpy.cythons.autogen.smoothutils.smooth_logistic1">
<code class="descclassname">hydpy.cythons.autogen.smoothutils.</code><code class="descname">smooth_logistic1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic1" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothing kernel based on the logistic function.</p>
<p><span class="math">\(f_{log1}(x, c) = 1-\frac{1}{1+exp(x/c)}\)</span></p>
<p>The following example shows the typical shape of the logistic function
for four different smoothing parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.objecttools</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;value, par=10.0,  par=1.0,  par=0.1,  par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic1</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">value, par=10.0,  par=1.0,  par=0.1,  par=0.0</span>
<span class="go">   -5, 0.377541, 0.006693, 0.000000, 0.000000</span>
<span class="go">   -4, 0.401312, 0.017986, 0.000000, 0.000000</span>
<span class="go">   -3, 0.425557, 0.047426, 0.000000, 0.000000</span>
<span class="go">   -2, 0.450166, 0.119203, 0.000000, 0.000000</span>
<span class="go">   -1, 0.475021, 0.268941, 0.000045, 0.000000</span>
<span class="go">    0, 0.500000, 0.500000, 0.500000, 0.500000</span>
<span class="go">    1, 0.524979, 0.731059, 0.999955, 1.000000</span>
<span class="go">    2, 0.549834, 0.880797, 1.000000, 1.000000</span>
<span class="go">    3, 0.574443, 0.952574, 1.000000, 1.000000</span>
<span class="go">    4, 0.598688, 0.982014, 1.000000, 1.000000</span>
<span class="go">    5, 0.622459, 0.993307, 1.000000, 1.000000</span>
</pre></div>
</div>
<p>With the highest value of the smoothing parameter (10.0), the result
approximates a streight line.  With the lowest smoothing parameter (0.0),
the result is identical with a discontinous first order step function.</p>
<p>Function <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic1" title="hydpy.cythons.autogen.smoothutils.smooth_logistic1"><code class="xref py py-func docutils literal"><span class="pre">smooth_logistic1()</span></code></a> is protected against numerical overflow.
Hence even extremely high <cite>value/parameter</cite> ratios are allowed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">smooth_logistic1</span><span class="p">(</span><span class="mf">1000.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">))</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.cythons.autogen.smoothutils.smooth_logistic2">
<code class="descclassname">hydpy.cythons.autogen.smoothutils.</code><code class="descname">smooth_logistic2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic2" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothing kernel based on the integral of the logistic function.</p>
<p><span class="math">\(f_{log2}(x, c) = c \cdot ln(1+exp(x/c))\)</span></p>
<p>The following example shows the shape of the integral of the
logistic function for four different smoothing parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.objecttools</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;value, par=3.0,  par=1.0,  par=0.1,  par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">value, par=10.0,  par=1.0,  par=0.1,  par=0.0</span>
<span class="go">   -5, 4.740770, 0.006715, 0.000000, 0.000000</span>
<span class="go">   -4, 5.130153, 0.018150, 0.000000, 0.000000</span>
<span class="go">   -3, 5.543552, 0.048587, 0.000000, 0.000000</span>
<span class="go">   -2, 5.981389, 0.126928, 0.000000, 0.000000</span>
<span class="go">   -1, 6.443967, 0.313262, 0.000005, 0.000000</span>
<span class="go">    0, 6.931472, 0.693147, 0.069315, 0.000000</span>
<span class="go">    1, 7.443967, 1.313262, 1.000005, 1.000000</span>
<span class="go">    2, 7.981389, 2.126928, 2.000000, 2.000000</span>
<span class="go">    3, 8.543552, 3.048587, 3.000000, 3.000000</span>
<span class="go">    4, 9.130153, 4.018150, 4.000000, 4.000000</span>
<span class="go">    5, 9.740770, 5.006715, 5.000000, 5.000000</span>
</pre></div>
</div>
<p>With the highest value of the smoothing parameter (3.0), the resulting
line is relatively straight.  With the lowest smoothing parameter (0.0),
the result is identical with a second order discontinous step function.</p>
<p>Function <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic2" title="hydpy.cythons.autogen.smoothutils.smooth_logistic2"><code class="xref py py-func docutils literal"><span class="pre">smooth_logistic2()</span></code></a> is protected against numerical overflow.
Hence even extremely high <cite>value/parameter</cite> ratios are allowed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">smooth_logistic2</span><span class="p">(</span><span class="mf">1000.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">))</span>
<span class="go">1000.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.cythons.autogen.smoothutils.smooth_logistic2_derivative">
<code class="descclassname">hydpy.cythons.autogen.smoothutils.</code><code class="descname">smooth_logistic2_derivative</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic2_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of the function <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic2" title="hydpy.cythons.autogen.smoothutils.smooth_logistic2"><code class="xref py py-func docutils literal"><span class="pre">smooth_logistic2()</span></code></a> regarding its
smoothing parameter.</p>
<p><span class="math">\(\frac{d}{dc}f_{log2}(x, c) =
\frac{x}{c \cdot exp(x/c)+c} \cdot ln(exp(-x/c)+1)\)</span></p>
<p>The following example shows the derivates for four different smoothing
parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.objecttools</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;value,  par=3.0,  par=1.0,  par=0.1, par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2_derivative</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">value,  par=3.0,  par=1.0,  par=0.1,  par=0.0</span>
<span class="go">   -5, 0.437790, 0.040180, 0.000000, 0.000000</span>
<span class="go">   -4, 0.512107, 0.090095, 0.000000, 0.000000</span>
<span class="go">   -3, 0.582203, 0.190865, 0.000000, 0.000000</span>
<span class="go">   -2, 0.640533, 0.365334, 0.000000, 0.000000</span>
<span class="go">   -1, 0.679449, 0.582203, 0.000499, 0.000000</span>
<span class="go">    0, 0.693147, 0.693147, 0.693147, 0.693147</span>
<span class="go">    1, 0.679449, 0.582203, 0.000499, 0.000000</span>
<span class="go">    2, 0.640533, 0.365334, 0.000000, 0.000000</span>
<span class="go">    3, 0.582203, 0.190865, 0.000000, 0.000000</span>
<span class="go">    4, 0.512107, 0.090095, 0.000000, 0.000000</span>
<span class="go">    5, 0.437790, 0.040180, 0.000000, 0.000000</span>
</pre></div>
</div>
<p>The validity of the calculated derivatives can be inspected by comparing
with sufficiently accurate numerical approximations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;value,  par=3.0,  par=1.0,  par=0.1,  par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">est</span> <span class="o">=</span> <span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="o">+</span><span class="n">dc</span><span class="p">)</span> <span class="o">-</span>
<span class="gp">... </span>               <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">))</span><span class="o">/</span><span class="n">dc</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">est</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">value,  par=3.0,  par=1.0,  par=0.1,  par=0.0</span>
<span class="go">   -5, 0.437790, 0.040180, 0.000000, 0.000000</span>
<span class="go">   -4, 0.512107, 0.090095, 0.000000, 0.000000</span>
<span class="go">   -3, 0.582203, 0.190865, 0.000000, 0.000000</span>
<span class="go">   -2, 0.640533, 0.365334, 0.000000, 0.000000</span>
<span class="go">   -1, 0.679449, 0.582203, 0.000499, 0.000000</span>
<span class="go">    0, 0.693147, 0.693147, 0.693147, 0.693147</span>
<span class="go">    1, 0.679449, 0.582203, 0.000499, 0.000000</span>
<span class="go">    2, 0.640533, 0.365334, 0.000000, 0.000000</span>
<span class="go">    3, 0.582203, 0.190865, 0.000000, 0.000000</span>
<span class="go">    4, 0.512107, 0.090095, 0.000000, 0.000000</span>
<span class="go">    5, 0.437790, 0.040180, 0.000000, 0.000000</span>
</pre></div>
</div>
<p>Function <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic2_derivative" title="hydpy.cythons.autogen.smoothutils.smooth_logistic2_derivative"><code class="xref py py-func docutils literal"><span class="pre">smooth_logistic2_derivative()</span></code></a> is protected against
numerical overflow. Hence even extremely high negative`value/parameter`
ratios are allowed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">smooth_logistic2_derivative</span><span class="p">(</span><span class="o">-</span><span class="mf">1000.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.cythons.autogen.smoothutils.smooth_logistic3">
<code class="descclassname">hydpy.cythons.autogen.smoothutils.</code><code class="descname">smooth_logistic3</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic3" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothing kernel which combines <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic1" title="hydpy.cythons.autogen.smoothutils.smooth_logistic1"><code class="xref py py-func docutils literal"><span class="pre">smooth_logistic1()</span></code></a>  and
<a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_logistic2" title="hydpy.cythons.autogen.smoothutils.smooth_logistic2"><code class="xref py py-func docutils literal"><span class="pre">smooth_logistic2()</span></code></a> for the regularization of functions containing
two second order discontinuities.</p>
<p><span class="math">\(f_{log3}(x, c) =
(1-w) \cdot f_{log2}(x, c) + w \cdot (1-f_{log2}(x, c))\)</span></p>
<p><span class="math">\(w = f_{log2}(x-1/2, d)\)</span></p>
<p><span class="math">\(d = max(0.54 \cdot c^{1.17}, 0.025)\)</span></p>
<p>The following example shows the shape of this combined smoothing
function for three different smoothing parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.objecttools</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">arange</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;value,  par=3.0,  par=1.0,  par=0.1,  par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic3</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">value,  par=3.0,  par=1.0,  par=0.1,  par=0.1</span>
<span class="go"> -5.5, 0.167513, 0.003996, 0.000000, 0.000000</span>
<span class="go"> -4.5, 0.206271, 0.010618, 0.000000, 0.000000</span>
<span class="go"> -3.5, 0.251687, 0.027603, 0.000000, 0.000000</span>
<span class="go"> -2.5, 0.304292, 0.068844, 0.000000, 0.000000</span>
<span class="go"> -1.5, 0.364136, 0.158615, 0.000000, 0.000000</span>
<span class="go"> -0.5, 0.430211, 0.314615, 0.000672, 0.000000</span>
<span class="go">  0.5, 0.500000, 0.500000, 0.500000, 0.500000</span>
<span class="go">  1.5, 0.569789, 0.685385, 0.999328, 1.000000</span>
<span class="go">  2.5, 0.635864, 0.841385, 1.000000, 1.000000</span>
<span class="go">  3.5, 0.695708, 0.931156, 1.000000, 1.000000</span>
<span class="go">  4.5, 0.748313, 0.972397, 1.000000, 1.000000</span>
<span class="go">  5.5, 0.793729, 0.989382, 1.000000, 1.000000</span>
</pre></div>
</div>
<p>With the highest value of the smoothing parameter (3.0), the resulting
line is relatively straight.  With the lowest smoothing parameter (0.0),
the result is identical with a function with two second order
discontinuities.</p>
</dd></dl>

<dl class="function">
<dt id="hydpy.cythons.autogen.smoothutils.smooth_max1">
<code class="descclassname">hydpy.cythons.autogen.smoothutils.</code><code class="descname">smooth_max1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.cythons.autogen.smoothutils.smooth_max1" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothing kernel for approximating the maximum function for two
values based on the LogSumExp function.</p>
<p><span class="math">\(f_{max}(x, y, c) = c \cdot ln(exp(x/c)+exp(y/c))\)</span></p>
<p>The following example shows the different degree of approximation of
the maximum function for four different smoothing parameters.  Parameter
x is constantly set to 5, parameter y is varied between 0 and 10:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.objecttools</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;y_value, par=3.0,  par=1.0,  par=0.3,  par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_max1</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">y_value, par=3.0,  par=1.0,  par=0.3,  par=0.0</span>
<span class="go">      0, 5.519024, 5.006715, 5.000000, 5.000000</span>
<span class="go">      1, 5.701888, 5.018150, 5.000000, 5.000000</span>
<span class="go">      2, 5.939785, 5.048587, 5.000014, 5.000000</span>
<span class="go">      3, 6.243110, 5.126928, 5.000382, 5.000000</span>
<span class="go">      4, 6.620917, 5.313262, 5.010516, 5.000000</span>
<span class="go">      5, 7.079442, 5.693147, 5.207944, 5.000000</span>
<span class="go">      6, 7.620917, 6.313262, 6.010516, 6.000000</span>
<span class="go">      7, 8.243110, 7.126928, 7.000382, 7.000000</span>
<span class="go">      8, 8.939785, 8.048587, 8.000014, 8.000000</span>
<span class="go">      9, 9.701888, 9.018150, 9.000000, 9.000000</span>
<span class="go">     10, 10.519024, 10.006715, 10.00000, 10.00000</span>
</pre></div>
</div>
<p>With the highest value of the smoothing parameter (3.0), the resulting
line is relatively straight.  With the lowest smoothing parameter (0.0),
the result is identical with the usual (discontinuous) maximum function.</p>
<p>Function <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_max1" title="hydpy.cythons.autogen.smoothutils.smooth_max1"><code class="xref py py-func docutils literal"><span class="pre">smooth_max1()</span></code></a> is protected against numerical underflow
and overflow.  In the following example, extreme values are added to
both the x and the y value of 5 and 6 respectively.  The degree of
smoothing is always identical:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;-1e8&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;1e8&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">test</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_max1</span><span class="p">(</span><span class="n">test</span><span class="o">+</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">test</span><span class="o">+</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">-</span><span class="n">test</span><span class="p">)</span>
<span class="go">-1e8, 6.313262</span>
<span class="go">0.0, 6.313262</span>
<span class="go">1e8, 6.313262</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.cythons.autogen.smoothutils.smooth_min1">
<code class="descclassname">hydpy.cythons.autogen.smoothutils.</code><code class="descname">smooth_min1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.cythons.autogen.smoothutils.smooth_min1" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothing kernel for approximating the minimum function for two
values based on the LogSumExp function.</p>
<p><span class="math">\(f_{max}(x, y, c) = -c \cdot ln(exp(x/-c)+exp(y/-c))\)</span></p>
<p>The following example shows the different degree of approximation of
the minimum function for four different smoothing parameters.  Parameter
x is constantly set to 5, parameter y is varied between 0 and 10:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">smoothutils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.objecttools</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;y_value, par=3.0,  par=1.0,  par=0.3,  par=0.0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lfill</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_min1</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parameter</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rfill</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">y_value, par=3.0,  par=1.0,  par=0.3,  par=0.0</span>
<span class="go">      0, -0.519024, -0.006715, -0.00000, 0.000000</span>
<span class="go">      1, 0.298112, 0.981850, 1.000000, 1.000000</span>
<span class="go">      2, 1.060215, 1.951413, 1.999986, 2.000000</span>
<span class="go">      3, 1.756890, 2.873072, 2.999618, 3.000000</span>
<span class="go">      4, 2.379083, 3.686738, 3.989484, 4.000000</span>
<span class="go">      5, 2.920558, 4.306853, 4.792056, 5.000000</span>
<span class="go">      6, 3.379083, 4.686738, 4.989484, 5.000000</span>
<span class="go">      7, 3.756890, 4.873072, 4.999618, 5.000000</span>
<span class="go">      8, 4.060215, 4.951413, 4.999986, 5.000000</span>
<span class="go">      9, 4.298112, 4.981850, 5.000000, 5.000000</span>
<span class="go">     10, 4.480976, 4.993285, 5.000000, 5.000000</span>
</pre></div>
</div>
<p>With the highest value of the smoothing parameter (3.0), the resulting
line is relatively straight.  With the lowest smoothing parameter (0.0),
the result is identical with the usual (discontinuous) minimum function.</p>
<p>Function <a class="reference internal" href="#hydpy.cythons.autogen.smoothutils.smooth_min1" title="hydpy.cythons.autogen.smoothutils.smooth_min1"><code class="xref py py-func docutils literal"><span class="pre">smooth_min1()</span></code></a> is protected against numerical underflow
and overflow.  In the following example, extreme values are added to
both the x and the y value of 5 and 6 respectively.  The degree of
smoothing is always identical:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;-1e8&#39;</span><span class="p">,</span> <span class="s1">&#39; 0.0&#39;</span><span class="p">,</span> <span class="s1">&#39; 1e8&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">test</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_min1</span><span class="p">(</span><span class="n">test</span><span class="o">+</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">test</span><span class="o">+</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">-</span><span class="n">test</span><span class="p">)</span>
<span class="go">-1e8, 4.686738</span>
<span class="go"> 0.0, 4.686738</span>
<span class="go"> 1e8, 4.686738</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="pointerutils.html"
                        title="previous chapter">pointerutils</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="annutils.html"
                        title="next chapter">annutils</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/smoothutils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="annutils.html" title="annutils"
             >next</a> |</li>
        <li class="right" >
          <a href="pointerutils.html" title="pointerutils"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="cythons.html" >Cythons Modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Christoph Tyralla.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>